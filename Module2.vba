
Sub Module2():           For Each ws In Worksheets       Dim ticker As String      Dim OpenPrice As Double      Dim ClosePrice As Double      Dim YearlyChange As Double      Dim PercentChange As Double      Dim GreatestIncrease As Double      Dim GreatestDecrease As Double      Dim GreatestTotal As Double      Dim GreatestIncreaseTicker As String      Dim GreatestDecreaseTicker As String      Dim GreatestTotalTicker As String      Dim PriceRow As Long      PriceRow = 2            Total = 0            Dim SummaryTableRow As Integer      SummaryTableRow = 2            ws.Range("I1").Value = "Ticker"      ws.Range("J1").Value = "Yearly Change"      ws.Range("K1").Value = "Percent Change"      ws.Range("L1").Value = "Total Stock Volume"      ws.Range("P1").Value = "Ticker"      ws.Range("Q1").Value = "Value"      ws.Range("O2").Value = "Greatest % Increase"      ws.Range("O3").Value = "Greatest % Decrease"      ws.Range("O4").Value = "Greatest Total Volume"               LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row                 For i = 2 To LastRow:                        If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then                                          ticker = ws.Cells(i, 1).Value                                            Total = Total + ws.Range("G" & i).Value                                            ws.Range("I" & SummaryTableRow).Value = ticker                                             ws.Range("L" & SummaryTableRow).Value = Total                                             OpenPrice = ws.Range("C" & PriceRow).Value               ClosePrice = ws.Range("F" & i).Value               YearlyChange = ClosePrice - OpenPrice                                 If OpenPrice = 0 Then                      PercentChange = 0                     Else                         PercentChange = YearlyChange / OpenPrice                  End If                                                   ws.Range("J" & SummaryTableRow).Value = YearlyChange                  ws.Range("K" & SummaryTableRow).Value = PercentChange                  ws.Range("K" & SummaryTableRow).NumberFormat = "0.00%"                                                                  If ws.Range("J" & SummaryTableRow).Value > 0 Then                            ws.Range("J" & SummaryTableRow).Interior.ColorIndex = 4                        Else                            ws.Range("J" & SummaryTableRow).Interior.ColorIndex = 3                        End If                                                      SummaryTableRow = SummaryTableRow + 1                  PriceRow = i + 1                                                   Total = 0            Else              Total = Total + ws.Range("G" & i).Value                             End If                              Next i                GreatestIncrease = ws.Range("K2").Value        GreatestDecrease = ws.Range("K2").Value        GreatestTotal = ws.Range("L2").Value                        LastrowTicker = ws.Cells(Rows.Count, "I").End(xlUp).Row                        For r = 2 To LastrowTicker:               If ws.Range("K" & r + 1).Value > GreatestIncrease Then                  GreatestIncrease = ws.Range("K" & r + 1).Value                  GreatestIncreaseTicker = ws.Range("I" & r + 1).Value               ElseIf ws.Range("K" & r + 1).Value < GreatestDecrease Then                  GreatestDecrease = ws.Range("K" & r + 1).Value                  GreatestDecreaseTicker = ws.Range("I" & r + 1).Value                ElseIf ws.Range("L" & r + 1).Value > GreatestTotal Then                  GreatestTotal = ws.Range("L" & r + 1).Value                  GreatestTotalTicker = ws.Range("I" & r + 1).Value                End If            Next r                        ws.Range("P2").Value = GreatestIncreaseTicker            ws.Range("P3").Value = GreatestDecreaseTicker            ws.Range("P4").Value = GreatestTotalTicker            ws.Range("Q2").Value = GreatestIncrease            ws.Range("Q3").Value = GreatestDecrease            ws.Range("Q4").Value = GreatestTotal            ws.Range("Q2:Q3").NumberFormat = "0.00%"                Next wsEnd Sub